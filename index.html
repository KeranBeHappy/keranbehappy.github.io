<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <title>Kindle电子时钟</title>
    <style>
      body {
        font-family: 'Amazon Ember', Arial, sans-serif;
        color: #222;
        text-align: center;
        padding: 0px;
        margin: 0;
        height: 100vh;
      }

      .clock-container {
        max-width: 100vw;
        height: auto;
        background-color: #ffffff;
        padding: 15px;
        border-radius: 8px;
        margin-top: 10vh;
        padding-top: 20px;
      }

      .time-display {
        font-size: 15rem;
        font-weight: bold;
        margin: 10px 0;
        color: #000;
        line-height: 1.2;
      }

      .date-display {
        font-size: 5rem;
        margin: 10px 0 5px;
        color: #333;
      }

      .week-display {
        font-size: 4rem;
        margin: 5px 0 15px;
        color: #666;
        font-style: normal;
        font-style: italic;
      }

      .note {
        font-size: 0.9rem;
        color: #999;
        margin-top: 15px;
        line-height: 1.4;
        padding: 0 10px;
        font-style: italic;
      }
    </style>
  </head>
  <body>
    <div class="clock-container">
      <h3 style="color: #004b8d; margin: 10px 0 15px; font-size: 1.3rem">
        Kindle电子时钟
      </h3>
      <div class="time-display" id="time">00:00</div>
      <div class="date-display" id="date">2025年01月01日</div>
      <div class="week-display" id="week">星期六</div>
    </div>
    <div class="note">
      <div class="status" id="status">初始化中...</div>
      <p>发布时间: 2025年6月21日17:26:11</p>
    </div>
    <script>
      // 日志函数 - 尝试通过DOM显示状态
      function logStatus(message) {
        var statusEl = document.getElementById('status')
        if (statusEl) {
          statusEl.textContent = message
        }
      }

      var weekArray = [
        '星期日',
        '星期一',
        '星期二',
        '星期三',
        '星期四',
        '星期五',
        '星期六'
      ]

      function getTimeBySecond(status = 'run') {
        try {
          // 获取当前UTC时间
          var utcNow = new Date()

          // 添加8小时偏移量（UTC+8）
          var beijingTime = new Date(utcNow.getTime() + 8 * 60 * 60 * 1000)

          var seconds = beijingTime.getSeconds()

          if (status === 'init' || seconds == 0) {
            // 同步时分
            var hours = beijingTime.getHours()
            var minutes = beijingTime.getMinutes()

            if (hours < 10) {
              hours = '0' + hours
            }
            if (minutes < 10) {
              minutes = '0' + minutes
            }
            document.getElementById('time').textContent = hours + ':' + minutes

            // 同步年月日
            var year = beijingTime.getFullYear()
            var month = beijingTime.getMonth() + 1
            var day = beijingTime.getDate()

            if (month < 10) {
              month = '0' + month
            }
            if (day < 10) {
              day = '0' + day
            }
            document.getElementById('date').textContent =  year + '年' + month + '月' + day + '日'

            // 同步星期
            var weekIndex = beijingTime.getDay()
            document.getElementById('week').textContent = weekArray[weekIndex]

            logStatus('上次更新: ' + beijingTime.toLocaleTimeString())
          }
        } catch (error) {
          logStatus('更新失败: ' + error.message)
        }
      }

      try {
        getTimeBySecond('init')
        logStatus('时钟已启动，每分钟更新一次')

        // 使用不同的定时器实现方式
        if (typeof setInterval === 'function') {
          setInterval(getTimeBySecond, 1000)
        } else {
          // 备用方案：使用setTimeout循环
          function loopUpdate() {
            getTimeBySecond()
            setTimeout(loopUpdate, 1000)
          }
          setTimeout(loopUpdate, 1000)
        }
      } catch (error) {
        logStatus('初始化失败: ' + error.message)
      }
    </script>
  </body>
</html>
